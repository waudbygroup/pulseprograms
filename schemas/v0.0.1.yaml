# NMR Pulse Sequence Annotation Schema v0.0.1
# This schema defines the structure and validation rules for pulse sequence metadata

$schema: "http://json-schema.org/draft-07/schema#"
$id: "https://github.com/waudbygroup/pulseprograms/schemas/v0.0.1.yaml"
title: "NMR Pulse Sequence Metadata Schema"
description: "Schema for validating YAML metadata embedded in NMR pulse program files"
version: "0.0.1"

type: object
required:
  - schema_version
  - sequence_version
  - title
  - authors
  - created
  - last_modified
  - repository
  - status

properties:
  schema_version:
    type: string
    pattern: "^0\\.0\\.1$"
    description: "Version of this annotation schema"
    
  sequence_version:
    type: string
    pattern: "^\\d+\\.\\d+\\.\\d+$"
    description: "Semantic version of the pulse sequence"
    
  title:
    type: string
    minLength: 1
    maxLength: 100
    description: "Short, descriptive sequence name"
    
  authors:
    type: array
    items:
      oneOf:
        - type: string
          pattern: "^[^<]+<[^>]+>$"
          description: "Author name with email: 'Name <email@domain.com>'"
        - type: string
          minLength: 1
          description: "Author name only"
    minItems: 1
    description: "List of sequence authors"
    
  created:
    type: string
    pattern: "^\\d{4}-\\d{2}-\\d{2}$"
    description: "Creation date in YYYY-MM-DD format"
    
  last_modified:
    type: string
    pattern: "^\\d{4}-\\d{2}-\\d{2}$"
    description: "Last modification date in YYYY-MM-DD format"
    
  repository:
    type: string
    pattern: "^[a-zA-Z0-9._/-]+$"
    description: "Repository identifier (e.g., github.com/user/repo)"

  # Optional fields
  experiment_type:
    type: array
    items:
      type: string
      minLength: 1
    description: "Array of experiment type keywords"

  features:
    type: array
    items:
      type: string
      minLength: 1
    description: "Array of feature keywords"
    
  nuclei_hint:
    type: array
    items:
      type: string
      pattern: "^\\d+[A-Z][a-z]?$"
      description: "Nucleus in standard isotope notation (e.g., 1H, 13C)"
    description: "Nuclei involved in the experiment"
    
  description:
    type: string
    maxLength: 500
    description: "Detailed description of the sequence"
    
  citation:
    type: array
    items:
      type: string
      minLength: 1
    description: "Literature citations"
    
  doi:
    type: array
    items:
      type: string
      pattern: "^10\\..+/.+$"
    description: "DOI identifiers for related publications"
    
  status:
    type: string
    enum: ["experimental", "beta", "stable", "deprecated"]
    description: "Development/validation status"

additionalProperties: true  # Allow community to add informal fields

examples:
  - schema_version: "0.0.1"
    sequence_version: "1.0.0"
    title: SOFAST-HMQC
    experiment_type: [hmqc, 2d]
    features: [sofast, sensitivity enhancement, selective excitation]
    nuclei_hint: [1H, 13C, 15N]
    authors:
      - Chris Waudby <c.waudby@ucl.ac.uk>
      - P. Schanda
    created: 2024-01-15
    last_modified: 2025-08-15
    repository: github.com/waudbygroup/pulseprograms
    description: 1H,15N SOFAST-HMQC for rapid or sensitive measurements
    citation:
      - Schanda & Brutscher, J. Am. Chem. Soc. (2005) 127, 8014
    doi:
      - 10.1021/ja051306e
    status: stable